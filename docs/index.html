<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CellNet, for cancer • cancerCellNet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="CellNet, for cancer">
<meta property="og:description" content="CellNet, for cancer">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">cancerCellNet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
<div id="cancercellnet-ccn" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#cancercellnet-ccn" class="anchor"></a>cancerCellNet (CCN)</h1></div>
<p><a href="#setup_ccn">Shortcut to Setup CCN</a></p>
<p><a href="#broadTrain_ccn">Shortcut to Broad Training CCN</a></p>
<p><a href="#subTrain_ccn">Shortcut to Subclass Training CCN</a></p>
<p><a href="#broadVal_ccn">Shortcut to Broad Validation CCN</a></p>
<p><a href="#subVal_ccn">Shortcut to Subclass Validation CCN</a></p>
<p><a href="#app_BRCA">Shortcut to Application of CCN</a></p>
<p><a href="#app_broad">Shortcut to Application of Broad Classifier on BRCA CCLE data</a></p>
<p><a href="#gene_comp">Shortcut to Gene Visualization/Comparison Tool</a></p>
<p><a href="#sub_app">Shortcut to subclass application on BRCA CCLE data</a></p>
<p><a href="#GEMM_geneConvert">Shortcut to class application on PAAD GEMM data</a></p>
<div id="setting-up-ccn" class="section level4">
<h4 class="hasAnchor">
<a href="#setting-up-ccn" class="anchor"></a><a name="setup_ccn">Setting up CCN</a>
</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">install_github</span>(<span class="st">"pcahan1/cancerCellNet"</span>, <span class="dt">ref=</span><span class="st">"master"</span>, <span class="dt">auth=</span><span class="st">"your_token_here"</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"pheatmap"</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"RColorBrewer"</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"randomForest"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"ggplot2"</span>)</a></code></pre></div>
</div>
<div id="fetch-the-required-files-if-you-have-not-already-donwloaded-them" class="section level3">
<h3 class="hasAnchor">
<a href="#fetch-the-required-files-if-you-have-not-already-donwloaded-them" class="anchor"></a>Fetch the required files if you have not already donwloaded them</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"https://s3.amazonaws.com/cnobjects/cancerCellNet/resources/BroadClassifier_return_20190118.rda"</span>, <span class="st">"BroadClassifier_return_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"https://s3.amazonaws.com/cnobjects/cancerCellNet/resources/ExampleSampTab_20190118.rda"</span>, <span class="st">"ExampleSampTab_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"https://s3.amazonaws.com/cnobjects/cancerCellNet/resources/expGDC_raw_20190118.rda"</span>, <span class="st">"expGDC_raw_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"https://s3.amazonaws.com/cnobjects/cancerCellNet/resources/intersecting_genes_20190120.rda"</span>, <span class="st">"intersecting_genes_20190120.rda"</span>)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"https://s3.amazonaws.com/cnobjects/cancerCellNet/resources/SubClassifier_return_20190118.rda"</span>, <span class="st">"SubClassifier_return_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"https://s3.amazonaws.com/cnobjects/cancerCellNet/resources/GSE102598_LL_RNAseq_2017_rsem_est_counts_mm9_unique.csv"</span>, <span class="st">"GSE102598_LL_RNAseq_2017_rsem_est_counts_mm9_unique.csv"</span>)</a></code></pre></div>
</div>
<div id="broad-class-training" class="section level3">
<h3 class="hasAnchor">
<a href="#broad-class-training" class="anchor"></a><a name="broadTrain_ccn">Broad Class Training</a>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cancerCellNet)</a>
<a class="sourceLine" id="cb3-2" title="2">expGDC =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"expGDC_raw_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">exampleSampTab =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"ExampleSampTab_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">iGenes =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"intersecting_genes_20190120.rda"</span>)</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">exampleSampTab</a></code></pre></div>
<p>Load in the training data, example sample table and intersecting genes.</p>
<p><img src="md_img/sampTab_20190120.PNG"></p>
<p>The sample table shown above maps each sample in the training data to a broad class and a sub class.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">stList =<span class="st"> </span><span class="kw"><a href="reference/splitCommon.html">splitCommon</a></span>(exampleSampTab, <span class="dt">ncells=</span><span class="dv">40</span>, <span class="dt">dLevel =</span> <span class="st">"BroadClass"</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">stTrain =<span class="st"> </span>stList[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4">expTrain =<span class="st"> </span>expGDC[iGenes, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(stTrain<span class="op">$</span>SampleBarCodes)]</a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6">returnBroad =<span class="st"> </span><span class="kw"><a href="reference/broadClass_train.html">broadClass_train</a></span>(<span class="dt">stTrain =</span> stTrain, <span class="dt">expTrain =</span> expTrain, <span class="dt">colName_cat =</span> <span class="st">"BroadClass"</span>, <span class="dt">colName_samp =</span> <span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/save">save</a></span>(returnBroad, <span class="dt">file=</span><span class="st">"BroadClassifier_return.rda"</span>)</a></code></pre></div>
<p>Randomly select 40 training samples in each broad category using “splitCommon” function and pass into “broadClass_train” for training a broad classifier.</p>
<p>Alternative, you could apply stratified sampling and quick pair transform to reduce training time. For using stratified sampling, you could use all the samples (even imbalanced sample size) in training.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">returnBroad =<span class="st"> </span><span class="kw"><a href="reference/broadClass_train.html">broadClass_train</a></span>(<span class="dt">stTrain =</span> stTrain, <span class="dt">expTrain =</span> expTrain, <span class="dt">colName_cat =</span> <span class="st">"BroadClass"</span>, <span class="dt">colName_samp =</span> <span class="st">"SampleBarCodes"</span>, <span class="dt">nRand =</span> <span class="dv">70</span>, <span class="dt">nTopGenes =</span> <span class="dv">25</span>, <span class="dt">nTopGenePairs =</span> <span class="dv">70</span>, <span class="dt">nTrees =</span> <span class="dv">2000</span>, <span class="dt">stratify=</span><span class="ot">TRUE</span>, <span class="dt">sampsize=</span><span class="dv">60</span>, <span class="dt">quickPairs=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/save">save</a></span>(returnBroad, <span class="dt">file=</span><span class="st">"BroadClassifier_return.rda"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(returnBroad)</a>
<a class="sourceLine" id="cb6-2" title="2">[<span class="dv">1</span>] <span class="st">"expTnorm"</span>    <span class="st">"sampTab"</span>     <span class="st">"cgenes_list"</span> <span class="st">"cnProc"</span></a></code></pre></div>
<p>In the returnBroad list, there are 4 items. “expTnorm” is the normalized expression matrix for the training samples. “sampTab” is the sample table of training samples. “cgenes_list” is a named list with all the genes belonging in each category. “cnProc” is a list that contains various components needed for prediction including the classifier object.</p>
</div>
<div id="subclass-training" class="section level3">
<h3 class="hasAnchor">
<a href="#subclass-training" class="anchor"></a><a name="subTrain_ccn">Subclass Training</a>
</h3>
<p>To start the subclass training, you need the cnProc from the broad class training.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">stList_sub =<span class="st"> </span><span class="kw"><a href="reference/splitCommon.html">splitCommon</a></span>(exampleSampTab, <span class="dt">ncells=</span><span class="dv">20</span>, <span class="dt">dLevel=</span><span class="st">"SubClass"</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">stTrain_sub =<span class="st"> </span>stList_sub[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4">expTrain_sub =<span class="st"> </span>expGDC[iGenes, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(stTrain_sub<span class="op">$</span>SampleBarCodes)]</a>
<a class="sourceLine" id="cb7-5" title="5">cnProc_broad =<span class="st"> </span>returnBroad<span class="op">$</span>cnProc</a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7">returnSubClass =<span class="st"> </span><span class="kw"><a href="reference/subClass_train.html">subClass_train</a></span>(<span class="dt">cnProc_broad =</span> cnProc_broad,</a>
<a class="sourceLine" id="cb7-8" title="8">                                <span class="dt">stTrain =</span> stTrain_sub,</a>
<a class="sourceLine" id="cb7-9" title="9">                                <span class="dt">expTrain =</span> expTrain_sub,</a>
<a class="sourceLine" id="cb7-10" title="10">                                <span class="dt">colName_broadCat =</span> <span class="st">"BroadClass"</span>,</a>
<a class="sourceLine" id="cb7-11" title="11">                                <span class="dt">colName_subClass =</span> <span class="st">"SubClass"</span>,</a>
<a class="sourceLine" id="cb7-12" title="12">                                <span class="dt">name_broadCat =</span> <span class="st">"TCGA-BRCA"</span>,</a>
<a class="sourceLine" id="cb7-13" title="13">                                <span class="dt">weight_broadClass =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-14" title="14">                                <span class="dt">colName_samp=</span><span class="st">"SampleBarCodes"</span>,</a>
<a class="sourceLine" id="cb7-15" title="15">                                <span class="dt">randomCat =</span> <span class="st">"Other_TCGA_CancerType"</span>)</a>
<a class="sourceLine" id="cb7-16" title="16"></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/save">save</a></span>(returnSubClass, <span class="dt">file=</span><span class="st">"SubClassifier_return.rda"</span>)</a></code></pre></div>
<p>Using the randomCat parameter, you can indicate the subcategory in the sample table that you want the classifier to sample from to generate the rand profiles. You can also leave the randomCat as the default to indicate that there are no specific subcategory that you wish to sample from to add to rand category</p>
</div>
<div id="broadclass-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#broadclass-validation" class="anchor"></a><a name="broadVal_ccn">BroadClass Validation</a>
</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># use the samples that are not used in training as validation samples to see how well the classifier performs</span></a>
<a class="sourceLine" id="cb8-2" title="2">stValList_Broad =<span class="st"> </span><span class="kw"><a href="reference/splitCommon.html">splitCommon</a></span>(stList[[<span class="dv">2</span>]], <span class="dt">ncells=</span><span class="dv">40</span>, <span class="dt">dLevel=</span><span class="st">"BroadClass"</span>) <span class="co">#because not all the cancer broad category have the same amount of samples, going to select the same amount validation samples for even comparison</span></a>
<a class="sourceLine" id="cb8-3" title="3">stVal_Broad =<span class="st"> </span>stValList_Broad[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5">stVal_Broad_ord =<span class="st"> </span>stVal_Broad[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(stVal_Broad<span class="op">$</span>BroadClass), ] <span class="co">#order by broadClass</span></a>
<a class="sourceLine" id="cb8-6" title="6">expVal_Broad =<span class="st"> </span>expGDC[iGenes, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(stVal_Broad_ord)]</a>
<a class="sourceLine" id="cb8-7" title="7">cnProc_broad =<span class="st"> </span>returnBroad<span class="op">$</span>cnProc <span class="co">#select the cnProc from the broadclass training earlier </span></a>
<a class="sourceLine" id="cb8-8" title="8">classMatrix_broad =<span class="st"> </span><span class="kw"><a href="reference/broadClass_predict.html">broadClass_predict</a></span>(cnProc_broad, expVal_Broad, <span class="dt">nrand =</span> <span class="dv">40</span>)</a></code></pre></div>
<p>After getting the classification matrix, you can plot it.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">stValRand_broad =<span class="st"> </span><span class="kw"><a href="reference/addRandToSampTab.html">addRandToSampTab</a></span>(classMatrix_broad, stVal_Broad_ord, <span class="st">"BroadClass"</span>, <span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">grps =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(stValRand_broad<span class="op">$</span>BroadClass)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(grps)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(stValRand_broad)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw"><a href="reference/ccn_hmClass.html">ccn_hmClass</a></span>(classMatrix_broad, <span class="dt">grps=</span>grps, <span class="dt">fontsize_row=</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="md_img/Broad_Classification_20190118.png"></p>
<p>You can also add gaps between each groups</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">breakVector =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>() <span class="co"># create a vector of number indicating the column at which the gap will be placed </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="cf">for</span> (uniqueClass <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(grps)) {</a>
<a class="sourceLine" id="cb10-3" title="3">   myBreak =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(grps <span class="op">%in%</span><span class="st"> </span>uniqueClass))</a>
<a class="sourceLine" id="cb10-4" title="4">   breakVector =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(breakVector, myBreak)</a>
<a class="sourceLine" id="cb10-5" title="5">}</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="kw"><a href="reference/ccn_hmClass.html">ccn_hmClass</a></span>(classMatrix_broad, <span class="dt">grps=</span>grps, <span class="dt">fontsize_row=</span><span class="dv">10</span>, <span class="dt">gaps_col =</span> breakVector) </a></code></pre></div>
<p><img src="md_img/breakBroadHeatmap_20190507.png"></p>
<p>You can also assess the performance of Broadclass classifier through PR cruves .</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># assessment</span></a>
<a class="sourceLine" id="cb11-2" title="2">assessmentDat =<span class="st"> </span><span class="kw"><a href="reference/ccn_classAssess.html">ccn_classAssess</a></span>(classMatrix_broad, stValRand_broad, <span class="st">"BroadClass"</span>,<span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="reference/plot_class_PRs.html">plot_class_PRs</a></span>(assessmentDat) <span class="co"># plot out the PR curves</span></a></code></pre></div>
<p><img src="md_img/PR_broad_20190118.png"></p>
</div>
<div id="subclass-validation" class="section level3">
<h3 class="hasAnchor">
<a href="#subclass-validation" class="anchor"></a><a name="subVal_ccn">SubClass Validation</a>
</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">stValList_sub =<span class="st"> </span><span class="kw"><a href="reference/splitCommon.html">splitCommon</a></span>(stList_sub[[<span class="dv">2</span>]], <span class="dt">ncells=</span><span class="dv">20</span>, <span class="dt">dLevel=</span><span class="st">"SubClass"</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">stVal_Sub =<span class="st"> </span>stValList_sub[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb12-3" title="3">stVal_Sub_ord =<span class="st"> </span>stVal_Sub[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(stVal_Sub<span class="op">$</span>SubClass), ] <span class="co">#order by cateogry</span></a>
<a class="sourceLine" id="cb12-4" title="4">expVal_sub =<span class="st"> </span>expGDC[iGenes, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(stVal_Sub_ord)]</a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6">cnProc_sub =<span class="st"> </span>returnSubClass<span class="op">$</span>cnProc</a>
<a class="sourceLine" id="cb12-7" title="7">classMatrix_sub =<span class="st"> </span><span class="kw"><a href="reference/subClass_predict.html">subClass_predict</a></span>(cnProc_broad, cnProc_sub, expVal_sub, <span class="dt">nrand =</span> <span class="dv">20</span>, <span class="dt">weight_broadClass =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>To classify subclasses, you need the cnProc of broad class classifier.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">stValRand_sub =<span class="st"> </span><span class="kw"><a href="reference/addRandToSampTab.html">addRandToSampTab</a></span>(classMatrix_sub, stVal_Sub_ord, <span class="st">"SubClass"</span>, <span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">grps =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(stValRand_sub<span class="op">$</span>SubClass)</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(grps)&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(stValRand_sub)</a>
<a class="sourceLine" id="cb13-4" title="4">grps[grps <span class="op">==</span><span class="st"> "Other_TCGA_CancerType"</span>] =<span class="st"> "rand"</span> <span class="co">#include other TCGA cancer as part of rand</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="kw"><a href="reference/ccn_hmClass.html">ccn_hmClass</a></span>(classMatrix_sub, <span class="dt">grps=</span>grps, <span class="dt">fontsize_row=</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="md_img/subClass_TCGA.png"></p>
<p>You can also assess the subclass classifier</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">stValRand_sub[stValRand_sub<span class="op">$</span>SubClass <span class="op">==</span><span class="st"> "Other_TCGA_CancerType"</span>, <span class="st">"SubClass"</span>] =<span class="st"> "rand"</span></a>
<a class="sourceLine" id="cb14-2" title="2">assessmentDat =<span class="st"> </span><span class="kw"><a href="reference/ccn_classAssess.html">ccn_classAssess</a></span>(classMatrix_sub, stValRand_sub, <span class="st">"SubClass"</span>,<span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw"><a href="reference/plot_class_PRs.html">plot_class_PRs</a></span>(assessmentDat) <span class="co"># plot out the PR curves</span></a></code></pre></div>
<p><img src="md_img/subTCGA_PR.png"></p>
</div>
<div id="application-of-classifiers" class="section level2">
<h2 class="hasAnchor">
<a href="#application-of-classifiers" class="anchor"></a><a name="app_BRCA">Application of classifiers</a>
</h2>
<div id="application-of-broad-classifer-on-brca-ccle-data-" class="section level3">
<h3 class="hasAnchor">
<a href="#application-of-broad-classifer-on-brca-ccle-data-" class="anchor"></a><a name="app_broad">Application of Broad classifer on BRCA CCLE data </a>
</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cancerCellNet)</a>
<a class="sourceLine" id="cb15-2" title="2">BRCA_CCLE =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"CCLE_BRCA.rda"</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4">returnBroad =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"BroadClassifier_return.rda"</span>)</a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6">expTnorm_broad =<span class="st"> </span>returnBroad[[<span class="st">"expTnorm"</span>]]</a>
<a class="sourceLine" id="cb15-7" title="7">sampTab_broad =<span class="st"> </span>returnBroad[[<span class="st">"sampTab"</span>]]</a>
<a class="sourceLine" id="cb15-8" title="8">cgenes_list_broad =<span class="st"> </span>returnBroad[[<span class="st">"cgenes_list"</span>]]</a>
<a class="sourceLine" id="cb15-9" title="9">cnProc_broad =<span class="st"> </span>returnBroad[[<span class="st">"cnProc"</span>]]</a>
<a class="sourceLine" id="cb15-10" title="10"></a>
<a class="sourceLine" id="cb15-11" title="11">classMatrix_broad =<span class="st"> </span><span class="kw"><a href="reference/broadClass_predict.html">broadClass_predict</a></span>(<span class="dt">cnProc =</span> cnProc_broad, <span class="dt">expDat =</span> BRCA_CCLE, <span class="dt">nrand =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="kw"><a href="reference/ccn_hmClass.html">ccn_hmClass</a></span>(classMatrix_broad, <span class="dt">fontsize_row=</span><span class="dv">10</span>, <span class="dt">fontsize_col =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="md_img/CCLE_BroadClass_20190118.png"></p>
</div>
<div id="gene-visualizationcomparison-tool" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-visualizationcomparison-tool" class="anchor"></a><a name="gene_comp">Gene Visualization/Comparison Tool</a>
</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">TCGA_geneAvg =<span class="st"> </span><span class="kw"><a href="reference/avgGeneCat.html">avgGeneCat</a></span>(<span class="dt">expDat =</span> expTnorm_broad, <span class="dt">sampTab =</span> sampTab_broad, <span class="dt">dLevel =</span> <span class="st">"BroadClass"</span>, <span class="dt">sampID =</span> <span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">BRCAnorm =<span class="st"> </span><span class="kw"><a href="reference/trans_prop.html">trans_prop</a></span>(<span class="kw"><a href="reference/weighted_down.html">weighted_down</a></span>(BRCA_CCLE, <span class="fl">5e5</span>, <span class="dt">dThresh=</span><span class="fl">0.25</span>), <span class="fl">1e5</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4">BRCAgenes =<span class="st"> </span>cgenes_list_broad<span class="op">$</span><span class="st">`</span><span class="dt">TCGA-BRCA</span><span class="st">`</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6">geneCompareMatrix =<span class="st"> </span><span class="kw"><a href="reference/makeGeneCompareTab.html">makeGeneCompareTab</a></span>(<span class="dt">queryExpTab =</span> BRCAnorm, <span class="dt">avgGeneTab =</span> TCGA_geneAvg, <span class="dt">querySample =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"CAL-51"</span>, <span class="st">"HCC1419"</span>), <span class="dt">trainingCat =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TCGA-BRCA_Avg"</span>, <span class="st">"TCGA-UCEC_Avg"</span>), <span class="dt">geneSamples =</span> BRCAgenes)</a>
<a class="sourceLine" id="cb16-7" title="7"></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="kw"><a href="reference/plotGeneComparison.html">plotGeneComparison</a></span>(geneCompareMatrix)</a></code></pre></div>
<p><img src="md_img/geneComparePlot_20190118.png"></p>
<p>You can also plot barplots for a single gene of interest</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">sdGene =<span class="st"> </span><span class="kw"><a href="reference/sdGeneCat.html">sdGeneCat</a></span>(<span class="dt">expDat =</span> expTnorm_broad, <span class="dt">sampTab =</span> sampTab_broad, <span class="dt">dLevel =</span> <span class="st">"BroadClass"</span>, <span class="dt">sampID =</span> <span class="st">"SampleBarCodes"</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw"><a href="reference/barPlotGene.html">barPlotGene</a></span>(geneCompareMatrix, <span class="dt">sdGeneCat =</span> sdGene, <span class="dt">gene =</span> <span class="st">"TRPS1"</span>)</a></code></pre></div>
<p><img src="md_img/singleGeneExpressionBar_20190118.png"></p>
</div>
<div id="subclassify-brca-ccle-data" class="section level3">
<h3 class="hasAnchor">
<a href="#subclassify-brca-ccle-data" class="anchor"></a><a name="sub_app">Subclassify BRCA CCLE data</a>
</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">broadReturn =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"BroadClassifier_return.rda"</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">subReturn =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"SubClassifier_return.rda"</span>)</a>
<a class="sourceLine" id="cb18-3" title="3">BRCA_CCLE =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"CCLE_BRCA.rda"</span>)</a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5">broad_cnProc =<span class="st"> </span>broadReturn<span class="op">$</span>cnProc</a>
<a class="sourceLine" id="cb18-6" title="6">sub_cnProc =<span class="st"> </span>subReturn<span class="op">$</span>cnProc_subClass</a>
<a class="sourceLine" id="cb18-7" title="7"></a>
<a class="sourceLine" id="cb18-8" title="8">CCLE_eval =<span class="st"> </span><span class="kw"><a href="reference/subClass_predict.html">subClass_predict</a></span>(<span class="dt">cnProc_broad =</span> broad_cnProc, <span class="dt">cnProc_sub =</span> sub_cnProc, <span class="dt">expDat =</span> BRCA_CCLE, <span class="dt">nrand=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-9" title="9">CCLE_evalOrd =<span class="st"> </span>CCLE_eval[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(CCLE_eval[<span class="dv">6</span>, ])]</a>
<a class="sourceLine" id="cb18-10" title="10"></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="kw"><a href="reference/ccn_hmClass.html">ccn_hmClass</a></span>(CCLE_evalOrd, <span class="dt">fontsize_row=</span><span class="dv">10</span>, <span class="dt">fontsize_col =</span> <span class="dv">6</span>)</a></code></pre></div>
<p><img src="md_img/subClass_CCLE_20190118.png"></p>
</div>
<div id="classify-gemm-data" class="section level3">
<h3 class="hasAnchor">
<a href="#classify-gemm-data" class="anchor"></a><a name="GEMM_geneConvert">Classify GEMM data</a>
</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cancerCellNet)</a>
<a class="sourceLine" id="cb19-2" title="2"></a>
<a class="sourceLine" id="cb19-3" title="3">GEMM_PAAD =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.csv</a></span>(<span class="st">"GSE102598_LL_RNAseq_2017_rsem_est_counts_mm9_unique.csv"</span>)</a>
<a class="sourceLine" id="cb19-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(GEMM_PAAD) =<span class="st"> </span>GEMM_PAAD<span class="op">$</span>X</a>
<a class="sourceLine" id="cb19-5" title="5">GEMM_PAAD<span class="op">$</span>X =<span class="st"> </span><span class="ot">NULL</span></a></code></pre></div>
<p><img src="md_img/GEMM_GeneOriginal.PNG"></p>
<p>To perform classification on GEMM or any mouse RNA-seq, we would have to perform gene conversion from mouse genes to human genes</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">GEMM_geneConvert =<span class="st"> </span><span class="kw"><a href="reference/utils_convertToGeneSymbols.html">utils_convertToGeneSymbols</a></span>(<span class="dt">expTab =</span> GEMM_PAAD, <span class="dt">typeMusGene =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>[1] “Could not convert 8393 genes.” <img src="md_img/GEMM_GeneConverted.PNG"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">returnBroad =<span class="st"> </span><span class="kw"><a href="reference/utils_loadObject.html">utils_loadObject</a></span>(<span class="st">"BroadClassifier_return_20190118.rda"</span>)</a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3">expTnorm_broad =<span class="st"> </span>returnBroad[[<span class="st">"expTnorm"</span>]]</a>
<a class="sourceLine" id="cb21-4" title="4">sampTab_broad =<span class="st"> </span>returnBroad[[<span class="st">"sampTab"</span>]]</a>
<a class="sourceLine" id="cb21-5" title="5">cgenes_list_broad =<span class="st"> </span>returnBroad[[<span class="st">"cgenes_list"</span>]]</a>
<a class="sourceLine" id="cb21-6" title="6">cnProc_broad =<span class="st"> </span>returnBroad[[<span class="st">"cnProc"</span>]]</a>
<a class="sourceLine" id="cb21-7" title="7"></a>
<a class="sourceLine" id="cb21-8" title="8">classMatrix_broad =<span class="st"> </span><span class="kw"><a href="reference/broadClass_predict.html">broadClass_predict</a></span>(<span class="dt">cnProc =</span> cnProc_broad, <span class="dt">expDat =</span> GEMM_geneConvert, <span class="dt">nrand =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="kw"><a href="reference/ccn_hmClass.html">ccn_hmClass</a></span>(classMatrix_broad, <span class="dt">fontsize_row=</span><span class="dv">10</span>, <span class="dt">fontsize_col =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="md_img/GEMM_broad.png"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/mit-license.php">MIT</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Patrick Cahan <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>

      <footer><div class="copyright">
  <p>Developed by Patrick Cahan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
